# 11. リスクおよび課題（Risks & Issues）

本章では、Drawing Evaluation App の開発および運用において予測される  
**リスク（将来発生する可能性のある問題）** と  
**課題（現時点で認識されている問題）** を整理する。

プロジェクトの成功確率を高めるためには、  
リスクを早期に認識し、対策方針を明確にしておくことが重要である。

---

# 11.1 評価ロジックに関するリスク

## 11.1.1 モデル精度の不安定さ
**内容**  
- 類似度スコアが意図と異なる値を返す可能性  
- 線精度や構図一致率などのサブスコアが不安定になる可能性

**原因**  
- 入力画像の品質差  
- 模写対象が白黒とはいえ、個々の描き方の癖  
- モデルの特徴抽出にノイズが含まれる

**対策**  
- スコアの正規化・クリッピング処理を導入  
- 複数アルゴリズムの併用（差分と類似度のハイブリッド）  
- β版で収集したデータをもとにスコア調整ロジックを改善

---

## 11.1.2 DeepSeek API 依存
**内容**  
講評生成が外部サービス（DeepSeek）に依存するため、  
- 混雑  
- API停止  
- 仕様変更  
などの影響を受ける可能性がある。

**対策**  
- 講評生成が失敗した場合は、スコアのみ返すフェイルセーフ  
- レスポンスが遅い場合はタイムアウト後に再試行  
- バージョン固定のAPIを使用し、仕様変更に備える

---

## 11.1.3 ヒートマップ生成のパフォーマンス問題
**内容**  
OpenCV の処理速度が端末やサーバースペックに依存する。

**対策**  
- サーバー側でGPU利用を前提にする  
- 生成処理は非同期ワーカーとして分離することを検討  
- ユーザーにはまずスコアを返し、ヒートマップは後から反映する構造も選択肢

---

# 11.2 コストに関するリスク

## 11.2.1 LLMコストの増加
**内容**  
DeepSeek のAPIはユーザー増加とともに利用量が増え、予想外のコストになる可能性。

**対策**  
- 講評を「短文モード」と「詳細モード」で切り替え  
- 一部をキャッシュし、同じ投稿には再生成しない  
- 月ごとの利用上限を設定する

---

## 11.2.2 ストレージ容量の増加
**内容**  
お題画像・提出画像・ヒートマップが蓄積するとストレージ費用が増える。

**対策**  
- 画像の圧縮率を調整する  
- 低解像度サムネイルを併用する  
- 古い提出を削除するオプションを提供（ユーザー任意）

---

# 11.3 開発フェーズに関するリスク

## 11.3.1 開発工数の予定超過
**内容**  
- 新技術の導入（React Native / FastAPI / PyTorch論理）で学習コストが高まる  
- 初期MVPに必要な実装量が多い

**対策**  
- 「最低限動く経路」を最優先で実装する（ログイン → お題 → 投稿 → 評価）  
- 05のTech Taskに沿って粒度を小さく分解  
- 機能追加より前に安定化を優先

---

## 11.3.2 モバイル特有の動作差
**内容**
- iOSとAndroidで挙動やAPI挙動、UIが微妙に違う  
- 画像アップロードやファイルパスまわりで不具合が起きやすい

**対策**
- Expoを使って挙動差を抑える  
- 実機テストを定期的に行う  
- OSバージョンの最低サポートを明確化する（iOS16 / Android10）

---

# 11.4 セキュリティに関するリスク

## 11.4.1 不正画像投稿
**内容**  
- NSFW画像  
- 著作権違反画像  
- 攻撃目的の画像（巨大画像でDoSなど）

**対策**  
- 投稿画像のファイルサイズ制限（10MB）  
- 拡張子チェック（JPEG/PNG）  
- 必要であれば NSFW 検査モデルを導入  
- スロットリング（短時間の大量送信を防ぐ）

---

## 11.4.2 JWTの漏洩
**内容**  
- 不正な第三者がトークンを盗んだ場合、ユーザーになりすまされる

**対策**  
- 有効期限を短めに設計  
- HTTPS 強制  
- モバイルは SecureStore 等に保存し、平文保存を避ける

---

# 11.5 ユーザー体験（UX）に関するリスク

## 11.5.1 スコアが理解されない
**内容**  
「この点数は良いのか悪いのか」「何を目安にすればいいの？」となる可能性。

**対策**  
- スコアの意味をチュートリアルで説明  
- 過去スコアと比較して成長を実感させるグラフ  
- LLM講評に「わかりやすい比較表現」を入れる

---

## 11.5.2 評価が遅く感じる
**内容**  
5秒は許容範囲だが、体感はユーザーの期待値に左右される。

**対策**  
- ローディング画面に「何をしているか」をステップ表示  
- スコアだけ先に返してヒートマップは後から表示  
- 再試行ボタンの導線改善

---

# 11.6 運用に関するリスク

## 11.6.1 クラッシュや例外処理不足
**内容**  
バージョンアップや外部API変更で例外が起きる可能性。

**対策**  
- try/exceptの統一された実装  
- エラーログの収集  
- バックエンドのヘルスチェック

---

## 11.6.2 ユーザーサポート負荷
**内容**  
β版で質問や不具合報告が多くなる可能性。

**対策**  
- よくある質問（FAQ）を作る  
- 問い合わせフォームは後で追加する設計にしておく  
- まずは小規模ユーザーでテストする

---

# 11.7 大規模アクセス時のリスク

## 11.7.1 同時アクセス増による評価待ち
**内容**  
PyTorch評価がCPU/GPUリソースを消費し、同時処理に制限がある。

**対策**  
- キューイングシステム（将来的に）を検討  
- まずは「評価中画面」で再試行を促すUX設計  
- 評価ワーカーのスケールアウトを前提にする

---

# 11.8 リスク全体のまとめ

本アプリは、  
- 外部API（DeepSeek）  
- 機械学習モデル（PyTorch）  
- モバイルアプリ（RN）  
- 外部ストレージ（Supabase/S3）  
など複数の領域が組み合わさる構成であるため、  
**性能・安定性・コスト・UX** の4点でリスクが発生しやすい。

しかし、本要件定義書で定義した以下の対策により、  
リスクの発生確率・影響範囲を最小限に抑えることができる：

- 最小構成（MVP）からスタートし、段階的に拡張する方針  
- 失敗時はスコアのみ返すフェイルセーフ  
- ユーザー体験の改善を常にログ・フィードバックから調整  
- コスト管理と外部API依存リスクの軽減  
- モジュール分割による保守性確保

---

**End of Document**

